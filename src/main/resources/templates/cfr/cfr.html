<!doctype html>
<html lang="kr"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/header :: header(~{::title})}">
    <title>CFR List</title>
</head>
<body th:with="principal=${#authentication.principal}">

<th:block th:replace="~{layout/nav :: nav}"/>

<div style="height:1000px;margin:15px;">
    <input type="hidden" id="id" th:value="${principal.users.id}" />
    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" id="imageInput" accept="image/jpeg, image/png" onchange="handleImageUpload(event)" required/>
        <div class="drop_item">
            <p>드래그용 아이템</p>
        </div>
        <button type="button" id="btn-cfrRequest">제출</button>
    </form>
    <img id="preview" />
</div>

<th:block th:replace="~{layout/footer :: footer}"/>

<script src="/js/cfr.js"></script>
<script src="/js/board.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.1/dist/browser-image-compression.js"></script>

<!--<main class="container">-->
<!--    <label class="label" id="label" for="input">-->
<!--        <div class="inner" id="inner">드래그하거나 클릭해서 업로드</div>-->
<!--    </label>-->
<!--    <input id="input" class="input" accept="image/*" type="file" required="true" multiple="true" hidden="true">-->

<!--</main>-->

<!--<script>-->
<!--   var input = document.getElementById("input");-->
<!--   var initLabel = document.getElementById("label");-->

<!--   input.addEventListener("change", (event) => {-->
<!--      const files = changeEvent(event);-->
<!--      handleUpdate(files);-->
<!--   });-->

<!--   initLabel.addEventListener("mouseover", (event) => {-->
<!--      event.preventDefault();-->
<!--      const label = document.getElementById("label");-->
<!--      label?.classList.add("label&#45;&#45;hover");-->
<!--   });-->

<!--   initLabel.addEventListener("mouseout", (event) => {-->
<!--      event.preventDefault();-->
<!--      const label = document.getElementById("label");-->
<!--      label?.classList.remove("label&#45;&#45;hover");-->
<!--   });-->

<!--   document.addEventListener("dragenter", (event) => {-->
<!--      event.preventDefault();-->
<!--      console.log("dragenter");-->
<!--      if (event.target.className === "inner") {-->
<!--         event.target.style.background = "#616161";-->
<!--      }-->
<!--   });-->

<!--   document.addEventListener("dragover", (event) => {-->
<!--      console.log("dragover");-->
<!--      event.preventDefault();-->
<!--   });-->

<!--   document.addEventListener("dragleave", (event) => {-->
<!--      event.preventDefault();-->
<!--      console.log("dragleave");-->
<!--      if (event.target.className === "inner") {-->
<!--         event.target.style.background = "#3a3a3a";-->
<!--      }-->
<!--   });-->

<!--   document.addEventListener("drop", (event) => {-->
<!--      event.preventDefault();-->
<!--      console.log("drop");-->
<!--      if (event.target.className === "inner") {-->
<!--         const files = event.dataTransfer?.files;-->
<!--         event.target.style.background = "#3a3a3a";-->
<!--         handleUpdate([...files]);-->
<!--      }-->
<!--   });-->

<!--   function changeEvent(event) {-->
<!--      const { target } = event;-->
<!--      return [...target.files];-->
<!--   };-->

<!--   function handleUpdate(fileList) {-->
<!--      const preview = document.getElementById("preview");-->

<!--      fileList.forEach((file) => {-->
<!--         const reader = new FileReader();-->
<!--         reader.addEventListener("load", (event) => {-->
<!--            const img = el("img", {-->
<!--               className: "embed-img",-->
<!--               src: event.target?.result,-->
<!--            });-->
<!--            const imgContainer = el("div", { className: "container-img" }, img);-->
<!--            preview.append(imgContainer);-->
<!--         });-->
<!--         reader.readAsDataURL(file);-->
<!--      });-->
<!--   };-->

<!--   function el(nodeName, attributes, ...children) {-->
<!--      const node =-->
<!--         nodeName === "fragment"-->
<!--            ? document.createDocumentFragment()-->
<!--            : document.createElement(nodeName);-->

<!--      Object.entries(attributes).forEach(([key, value]) => {-->
<!--         if (key === "events") {-->
<!--            Object.entries(value).forEach(([type, listener]) => {-->
<!--               node.addEventListener(type, listener);-->
<!--            });-->
<!--         } else if (key in node) {-->
<!--            try {-->
<!--               node[key] = value;-->
<!--            } catch (err) {-->
<!--               node.setAttribute(key, value);-->
<!--            }-->
<!--         } else {-->
<!--            node.setAttribute(key, value);-->
<!--         }-->
<!--      });-->

<!--      children.forEach((childNode) => {-->
<!--         if (typeof childNode === "string") {-->
<!--            node.appendChild(document.createTextNode(childNode));-->
<!--         } else {-->
<!--            node.appendChild(childNode);-->
<!--         }-->
<!--      });-->

<!--      return node;-->
<!--   }-->
<!--</script>-->

</body>
</html>